<%= render '/shared/alerts' %>
<%= render '/shared/masthead' %>

<table class="table" id="profile-table">
	
	<tr>
		<td>
			Name: 
		</td>
		<td>
			<%= @team_member.name %>
		</td>
	</tr>
	
	<tr>
		<td>
			Email: 
		</td>
		<td>
			<%= mail_to @team_member.email %>
		</td>
	</tr>
	
	<tr >
		<td>
			<%= link_to "Times in Contests:", user_contests_path( @team_member.id ) %> 
		</td>
		<td>
			<%= @team_member.times_in_contests %>
		</td>
	</tr>
	
	<tr class="winner">
		<td>
			Victories: 
		</td>
		<td>
			<%= @team_member.wins.count %>
		</td>
	</tr>
	
	<tr class="loser">
		<td>
			Defeats: 
		</td>
		<td>
			<%= @team_member.losses.count %>
		</td>
	</tr>
	
	<tr class="winner">
		<td>
			Best winning streak: 
		</td>
		<td>
			<%= @team_member.streak(:wins) %>
		</td>
	</tr>
	
	<tr class="loser">
		<td>
			Worst losing streak:
		</td>
		<td>
			<%= @team_member.streak(:losses) %>
		</td>
	</tr>	

<% if @last_victory %>
	
	<tr class="winner">
		<th colspan="2">Most Recent Victory</th>

	</tr>
	
	<tr class="winner">
		<td><%= link_to @last_victory.question.text, question_path(@last_victory.question.id) %><em> (<%= pretty_time(@last_victory.created_at) %>)</em></td>
		<td class="text-center"><%= portrait_link @last_victory.loser %></td>
	</tr>
	
<% end %>

<% if @last_defeat %>
	
	<tr class="loser">
		<th colspan="2">Most Recent Defeat</th>
	</tr>
	
	<tr class="loser">
		<td><%= link_to @last_defeat.question.text, question_path(@last_defeat.question.id) %><em> (<%= pretty_time(@last_defeat.created_at) %>)</em></td>
		<td class="text-center"><%= portrait_link @last_defeat.winner %></td>
		
	</tr>
	
<% end %>

</table>

<h2 class="blue"><%= @team_member.name.split(" ")[0] %>'s Contests</h2>

<table id="team-member-table" class="table">

	<% @contests.each do |contest| %>
		<% if @team_member.winner?(contest) %>
			<tr class="winner">
		<% else %>
			<tr class="loser">
		<% end %>
			<td>
				<%= link_to contest.question.text, question_path(contest.question.id) %> <em> (<%= pretty_time contest.created_at %>)</em>
			</td>
			<td class="small">
				<%= portrait_link( @team_member.opponent(contest) ) %>
			</td>
		</tr>
	<% end %>
</table>